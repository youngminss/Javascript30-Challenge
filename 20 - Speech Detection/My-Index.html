<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Speech Detection</title>
</head>
<body>
	
	<div class='words' contenteditable>

	</div>

<script>
	// ê¸€ë¡œë²Œ ì˜¤ë¸Œì íŠ¸ì— window.SpeechRecongnition ì¼ìˆ˜ë„ ìˆê³ , chrome ì˜ window.webkitSpeechRecognition ì¼ ìˆ˜ë„ ìˆë‚˜ ë´„
	window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
	
	const recognition = new SpeechRecognition();	// SpeechRecognition ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
	recognition.interimResults = true;	// ì¤‘ê°„ ê²°ê³¼ë¬¼ í—ˆìš©
	// recognition.lang = 'en-US';			// ë²ˆì—­ ê²°ê³¼ ì§€ì› ì–¸ì–´ì„¤ì •
	
	let p = document.createElement('p');
	const words = document.querySelector('.words');
	words.appendChild(p);

	// result, ì¤‘ê°„ì¤‘ê°„ ê²°ê³¼ë¬¼ ì´ë²¤íŠ¸
	recognition.addEventListener('result', e => {
		const transcript = Array.from(e.results)
			.map(result => result[0])
			.map(result => result.transcript)
			.join('');

		console.log(transcript);

		//	í•„í„°ë§ ê³¼ì •( í•„ìˆ˜ X )
		const poopScript = transcript.replace(/poop|poo|shit|dump/gi, 'ğŸ’©');
		p.textContent = poopScript;

		// isFinal => result ê°ì²´ ë‚´ë¶€ì— ë§ˆì§€ë§‰ ë¬¸ì¥ì¸ì§€ ì •ë³´ê°€ ìˆìŒ
		if(e.results[0].isFinal) {
			p = document.createElement('p');
			words.appendChild(p);
		};

	})

	recognition.addEventListener('end', recognition.start);	// end ì´ë²¤íŠ¸, í•œ ë¬¸ì¥ì´ ëë‚¬ì„ ê²½ìš°
	recognition.start();	// chrome ë§ˆì´í¬ on 

</script>

	<style>
		html {
			font-size: 10px;
		}

		body {
			background: #ffc600;
			font-family: 'helvetica neue';
			font-weight: 200;
			font-size: 20px;
		}

		.words {
			max-width: 500px;
			margin: 50px auto;
			background: white;
			border-radius: 5px;
			box-shadow: 10px 10px 0 rgba(0, 0, 0, 0.1);
			padding : 1rem, 2rem 1rem 5rem;
			background: -webkit-gradient(linear, 0 0, 0 100%, from(#d9eaf3), color-stop(4%, #fff)) 0 4px;
			background-size: 100% 3rem;
			position: relative;
			line-height: 3rem;
		}

		p {
			margin: 0 0 3rem;
		}

		.words:before {
			content: '';
			position: absolute;
			width: 4px;
			top: 0;
			left: 30px;
			bottom: 0;
			border: 1px solid;
			border-color: transparent #efe4e4;
		}
	</style>
</body>
</html>